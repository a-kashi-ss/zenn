---
title: "【初心者向け】AWS ECS"
emoji: "👩‍🍳"
type: "tech"
topics: ["aws","ecs","ecr","docker","初心者"]
published: true
published_at: 2025-12-1 05:00
publication_name: "secondselection"
---



# 【AWS ECS 初心者ガイド】FargateとECRを使いこなす！コンテナデプロイ実践ステップ

| 記事の目的 | AWS ECSの基本概念とFargate、ECRの使用方法を理解し、実際に動かすためのステップを解説する |
| :--- | :--- |
| ターゲット読者 | クラウド初心者、コンテナ技術に興味を持ち始めた若手エンジニア、もしくは初心者エンジニア |
| 想定キーワード | AWS ECS, Fargate, ECR, docker, ECS 使い方, コンテナ初心者 |

-----

**この記事を読むことで得られるメリット：**

  * **AWS ECS**とは何か、そしてなぜ多くの企業で採用されているのかが分かります。
  * サーバーレスな **Fargate** とコンテナレジストリ **ECR** の役割を理解し、コンテナデプロイの一連のフローを把握できます。
  * **Docker** イメージを実際にAWS上にデプロイするための具体的な手順を習得できます。

-----

## 1\. AWS ECSとは？コンテナオーケストレーションを学ぶ最初のステップ

クラウド技術の進化に伴い、アプリケーションのデプロイ手法も大きく変化しました。特に近年、**コンテナ** 技術の普及により、より高速でスケーラブルな開発・運用が可能になっています。そのコンテナをAWS上で効率的に管理・実行するためのサービスが、**AWS ECS（Elastic Container Service）** です。

あなたは今、コンテナ技術に興味を持ち、AWS上での実践を考えているのではないでしょうか？ **AWS ECS** は、まさにその一歩を踏み出すのに最適なサービスです。

### 1-1. そもそも「コンテナオーケストレーション」が必要な理由

**Docker** などのコンテナ技術を使えば、アプリケーションとその実行環境をひとつのパッケージとして扱うことができ、環境依存の問題を解消できます。

しかし、本番環境で数百・数千ものコンテナを運用するとなると、次のような課題が発生します。

  * どのサーバーに、どのコンテナを、いくつ配置するか？
  * コンテナがクラッシュした場合、自動で再起動できるか？
  * トラフィックが増えた際、自動でコンテナ数を増やせるか（スケーリング）？
  * 新しいバージョンのアプリケーションを、サービスを止めずに安全にデプロイできるか？

これらの複雑な管理作業を自動化してくれるのが、「**コンテナオーケストレーション**」です。**AWS ECS** は、AWSに特化したコンテナオーケストレーションサービスであり、この課題をシンプルに解決します。

### 1-2. ECS（Elastic Container Service）が持つ主要な役割とメリット

**AWS ECS** を利用する最大のメリットは、**インフラストラクチャ管理の複雑さから解放される** ことです。

| メリット | 詳細 |
| :--- | :--- |
| **高スケーラビリティ** | 負荷に応じてコンテナ数を自動で増減でき、急なトラフィック増加にも対応できます。 |
| **高い可用性** | コンテナのヘルスチェックを自動で行い、異常があれば自動で再起動・再配置してくれます。 |
| **AWSサービスとの連携** | VPC、IAM、CloudWatch、ALBなど、他のAWSサービスとシームレスに連携できます。 |
| **運用負荷の軽減** | コンテナの配置、スケジューリング、ネットワーキングなどの面倒な作業をAWSが代行します。 |

### 1-3. ECSを構成する3つの核：クラスタ、タスク、サービス

**ECS** のアーキテクチャを理解するために、最低限知っておくべき3つの主要な構成要素があります。

1.  **クラスタ（Cluster）**
      * **コンテナを実行するためのリソースのグループ** です。アプリケーションのデプロイ先となる論理的なまとまりだと考えてください。
2.  **タスク定義（Task Definition）**
      * アプリケーションの**設計図**です。「どのDockerイメージを使うか」「CPUとメモリをどれだけ割り当てるか」「どのポートを使うか」など、コンテナの実行に必要なすべての設定を記述します。
3.  **サービス（Service）**
      * タスク（実行中のコンテナ）の**維持管理者**です。「このタスクを**常に3つ**動かし続けてください」といった指示をECSに出し、 desired count（希望する実行数）を維持し、ロードバランサーとの連携などを管理します。

-----

## 2\. ECSの主要なパートナー技術を理解する

**AWS ECS** を実際に利用する際には、コンテナの「保管庫」と「実行環境」を提供する2つの重要なパートナー技術、**ECR** と **Fargate** の理解が欠かせません。

### 2-1. コンテナの保管庫：ECR（Elastic Container Registry）の役割

**ECR (Elastic Container Registry)** は、**Dockerイメージを安全に保管し、管理するためのAWSのサービス** です。

あなたがローカル環境で **Docker** イメージを作成したら、そのイメージを **ECR** に Push（プッシュ）します。ECSはデプロイ時に、この **ECR** からイメージをプルしてコンテナを実行します。これは、GitHubなどのコードリポジトリと似た役割を果たしますが、対象がコードではなくコンテナイメージである点が異なります。

### 2-2. サーバーレスな実行環境：Fargate vs. EC2の違いと選択基準

ECSでコンテナを実行する方法は、大きく分けて **Fargate** と **EC2** の2種類があります。

| 実行モード | Fargate | EC2 |
| :--- | :--- | :--- |
| **サーバー管理** | **AWSが完全に管理（サーバーレス）** | ユーザーがEC2インスタンスを管理 |
| **料金体系** | コンテナが使用したCPU/メモリの使用量に基づき課金 | EC2インスタンスの稼働時間に基づき課金 |
| **カスタマイズ性** | 低い（OSレベルのアクセス不可） | 高い（OS、ミドルウェアのカスタマイズ可能） |
| **デプロイの速さ** | 非常に速い | EC2起動時間や設定が必要な分、やや遅い |

### 2-3. Fargateが初心者・若手エンジニアに最適な理由

結論から言うと、**AWS ECS** を学ぶ最初のステップとしては **Fargate** が断然おすすめです。

**Fargate** は、コンテナ実行のための **EC2インスタンス（サーバー）の管理を一切AWSに任せる** ことができる「サーバーレス」な実行モードです。

  * OSのパッチ適用やセキュリティ設定など、面倒なインフラ管理が不要。
  * コンテナの実行に集中できるため、学習コストを最小限に抑えられます。

**あなたは、サーバー管理に煩わされることなく、純粋にアプリケーションのコンテナ化とデプロイの仕組みを学ぶことができる** のです。

-----

## 3\. 【実践編】AWS ECS Fargateを使ったコンテナデプロイの流れ

ここからは、実際に **Docker** イメージを作成し、**ECR** に登録、そして **ECS Fargate** で実行するまでの一連の手順をステップ形式で解説します。

### 3-1. STEP 1：Dockerイメージの作成とECRへのPush（コンテナレジストリ活用）

まず、アプリケーションの **Docker** イメージを用意し、それを **ECR** に登録します。

1.  **ECRリポジトリの作成:**
    AWSマネジメントコンソールでECRを開き、新しいリポジトリを作成します。リポジトリ名は `my-app-repository` など分かりやすい名前にしましょう。
2.  **ローカルでのDockerイメージのビルド:**
    お手元の `Dockerfile` からイメージをビルドします。
    ```bash
    # 例: my-appというタグでビルド
    docker build -t my-app .
    ```
3.  **ECRへのログインとPush:**
    ECRのリポジトリ詳細画面に表示されているコマンドを実行し、ローカルの **Docker** 環境を **ECR** にログインさせます。その後、イメージにタグを付け替えてプッシュします。
    ```bash
    # ログインコマンドを実行
    aws ecr get-login-password --region ap-northeast-1 | docker login --username AWS --password-stdin <YOUR_ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com

    # イメージにECR用のタグを付ける
    docker tag my-app:latest <YOUR_ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com/my-app-repository:latest

    # ECRへPush
    docker push <YOUR_ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com/my-app-repository:latest
    ```
    これで、あなたのコンテナイメージが **ECR** という安全な保管庫に格納されました。

### 3-2. STEP 2：ECSにおけるタスク定義（Task Definition）の作成

次に、**ECS** がコンテナを実行するための設計図である「**タスク定義**」を作成します。

  * **実行環境の指定:** Fargateを選択します。
  * **コンテナ情報の指定:** ECRにPushしたイメージのURIを指定します。
  * **リソースの指定:** タスク全体で利用するCPUとメモリ（例：CPU: 0.5 vCPU, メモリ: 1GB）を指定します。

**タスク定義** は、複数のコンテナを連携させて動かすマルチコンテナ構成にも対応できますが、まずは1つのアプリケーションコンテナから始めるのがおすすめです。

### 3-3. STEP 3：クラスタの作成とサービスの定義（デプロイの実行）

いよいよ **ECS** でアプリケーションを実行します。

1.  **クラスタの作成:**
    ECSコンソールで「クラスタの作成」を選択し、ネットワーク（VPC）モードのクラスタを作成します。
2.  **サービスの定義:**
    作成したクラスタ内で「サービス」を作成します。ここで最も重要な設定は以下の通りです。
      * **起動タイプ:** **Fargate** を選択。
      * **タスク定義:** STEP 2で作成した **タスク定義** を選択。
      * **希望するタスク数:** **常に動かしたいコンテナの数** を指定します（例: 2）。
      * **ネットワーク設定:** コンテナを配置する VPC、サブネット、セキュリティグループを設定します。
      * **ロードバランサー設定:** 必要に応じて、アプリケーションロードバランサー（ALB）との連携を設定します。

サービスが作成されると、**ECS** は自動的に指定された数の **Fargate** タスク（コンテナ）を起動し、安定した状態を維持し始めます。

### 3-4. デプロイ後の状態確認とログの調べ方

デプロイが完了したら、サービスの状態が `ACTIVE` になっていることを確認しましょう。

  * **パブリックIPアドレスの確認:** タスク詳細画面から、コンテナに割り当てられたパブリックIPアドレスを確認し、ブラウザでアクセスしてみます。
  * **ログの確認:** コンテナの実行ログは **Amazon CloudWatch Logs** に自動で連携されています。アプリケーションのエラーや標準出力は必ずここで確認しましょう。

これで、あなたは **AWS ECS Fargate** を使って、**Docker** コンテナを本番相当の環境で動かすという大きな一歩を踏み出しました。

-----

## 4\. ECS運用で知っておきたい発展的な知識

**ECS** の基本をマスターしたら、次はより堅牢で効率的な運用を目指しましょう。

### 4-1. ロードバランサー（ALB）との連携による可用性向上

本番環境では、タスクに直接アクセスするのではなく、**ALB (Application Load Balancer)** を介してアクセスするのが一般的です。

  * **トラフィック分散:** 複数のタスクに負荷を均等に分散できます。
  * **ヘルスチェック:** ALBが定期的にコンテナのヘルスチェックを行い、異常なタスクへのトラフィックを自動で遮断してくれます。

### 4-2. ECSにおける環境変数や機密情報の扱い（Secrets Manager/Parameter Store）

データベースのパスワードなどの**機密情報**をタスク定義に直接書き込むのはセキュリティ上危険です。

  * **AWS Secrets Manager** や **AWS Systems Manager Parameter Store** を使用することで、安全に環境変数や機密情報を **ECS** タスクに渡し、アプリケーションで使用することができます。

### 4-3. 監視・ロギングの基本（CloudWatchの活用）

**ECS** は **Amazon CloudWatch** と深く連携しています。

  * **ロギング:** コンテナ内の標準出力・標準エラー出力は、すべて **CloudWatch Logs** に集約されます。
  * **メトリクスとアラーム:** CPU使用率、メモリ使用率、タスク数などのメトリクスを監視し、異常が発生した際に通知する **アラーム** を設定することで、サービス停止を未然に防ぐことができます。

-----

## 5\. まとめと次のアクション：あなたのコンテナ活用を加速させるために

この記事では、**AWS ECS** の基本概念から、**Fargate** と **ECR** を組み合わせた実践的なコンテナデプロイ手順までを解説しました。

**AWS ECS** は、コンテナオーケストレーションの複雑さをAWSが肩代わりしてくれる、非常に強力なサービスです。特に **Fargate** を使えば、インフラ管理の手間なく、コンテナ技術の恩恵を最大限に享受できます。

**最後に、あなたの次のアクションとして、以下のステップをおすすめします。**

1.  **手を動かす:** この記事で学んだ手順を参考に、簡単なWebアプリケーションの **Docker** イメージを作成し、実際に **ECS Fargate** でデプロイしてみましょう。
2.  **IaC（Infrastructure as Code）の導入:** 手動での設定に慣れたら、**AWS CDK** や **Terraform** などのIaCツールを使って、ECSのインフラ構築をコード化することにチャレンジしましょう。これにより、環境構築の再現性と効率が劇的に向上します。

あなたのクラウドジャーニーが、この **AWS ECS** への挑戦によって、さらに加速することを願っています。

